#
# @lc app=leetcode id=424 lang=python3
#
# [424] Longest Repeating Character Replacement
#

# @lc code=start
from collections import Counter 
class Solution:
    def characterReplacement(self, s: str, k: int) -> int:
        # for windowSize in range(k):
        # s = "BAAABAABBBAAABBBBBBAABAAAAABBABBABABAABABBBBBAAAAAABAABABABBABAAAABBABABBAABBABAABAABAABBBBAABABABABAABAABBBAABBABABBBBBBBAAABAAABBBAABABBBABABAAAAAABBAABBBAABAAAAAABBABBAABBABABBABBBAAABBABBAAAABAABABBBABBABBABAABBBBAABABBABBBABBAABBAABBAAAABBBBBBAAAABAABAAAABBABABBBAABABBAAAAAAABABBBABABAAABBABAABAAAAABBABBABBABBABABBABBBBBBBBABABAABAAABABBBABAABABABBBABAAAAAAAABAAAAABBBABBAAABAAABBABABBBABBAABBBBABAABBBBBAAABAAABAABABBAAAABAABBAABABAABABBBAAABBBBABAABBABAABAAABAAABABBABBBBBABABBABBBBBBBBBAAAAABBBABAAABBABABABBBBABABABBBBABBBBBABBABBABBABAABABBAABBABBABABAAAABAAABAAABBBABABABBBBBBBABBABBAABBABABAABAAABABBABAAAABBBBBBBBABBBAABBAAAAABBABABAAABABBABBBBABBBAABBBAABAABAAAAAABBABABAAABBABBAABBAAAAAAAAABABAAABABBBABABBBABBAABBABAAAAABAABABABAABBBABAABABBBAABABBAABAAABABBBABBBBBABBBBABAABAABBABBAABBAABBBABBBABBAAAAAABBAAABAABBBAAABBBBAABBABBAAAABBABBAAABAABABAAAAABAAAABBAAAAAABAABBBAAAABAABBBABBABAABBAAABBBBBBBABBBBABBBABBBBBAAABBAABABBBBABBBAAABBAAABBABAAAAAABBABBAAAAABBBBABABAABBBABBBBABABBBBAABBBBAABBABAABABBAAABBABABAABBBABABBBBAAAAAAAABAAAAAABAAABBBAABBABBBABBABBBBBABAAAAABBBBAABBAAAABBABBAAAAABAAAABBBBABBBAABBAABBBBABABBBBAAAAAAAABAABBAAAABAAAABBAAABAAAAAABABAAABABABBAAAAABABBAAABAAABBAAAAABBABAABABAAAAABBAABABABBBABBABBBABABBABABBABBABBBBABAABAABBABBABAABBABAABABBBAAABBAABBABBABBABABAAAAAAAAABAABBABBBABBAAAABBABBAABBBBBABAABBABBAABBABABAAAAAAAAAAABBBAAABBAAAAAAABBABAAAABBBAABBBBABABBBBBABAABABBAAABBBBAAABABABBBBBAAAABABBABBBAABABBABBBAAAABBABBBAAAAAAABBAABABBBBBAABABBAAAABAAABBBBAABAAABBBBABBAABBBBBBBAAAABBBBABAAABAABBABABBAAAABAABABAAAAAAABBAABAAABBBABAABBBBBBBBBBABAABBAAAAABAAAAABABAAABBAABBAAAAABBBABBBBBBBBABBAAAABBAABBBAAABBAABBAAAABABBBAAABAAAAAAABBAAABBBBBBBBABAAABBAABBAAAABBAAABAAAAABBBAAAAAAAAABABBAAABBBABABBABAABAAAABBBBABAABBBAAABAABAABBABAAABBAABABBAABABAAABBAAAABABAABAABAABABBBBBAAAABAABBBBAABAABAABABBAAAABAABAAABAABBABABAAAABABBABBBBBBBAAABBABBBBBAABABABABAABBABAAABBBBBBAAAABABBAABAAAAABBBBABABABBBAAAABAABBBBBBBABAAABBBABBABBBBABBBAABBAABABABAABAABBAABBBAABAAAAABAABBAAABBABAABBBABBABBAABBAAAABABAAAABBBAAAABABABAABBBBABBABBBBBBAABBABBABBAAABBBBAAAABBBBAAAABBAABBAAAAAAAABBABBABABABAAAABBBBAAABBABBBBABABABBBABAAAABBBAAAABBAABABABBBABBAAAAABABBBBAAAAABAABABABABAAABBAAABBBBAABABBBAABBBAAABBBAABABAAABABBBABBABBBBABBBBAAABABAAAABABBBBBBABAAABBAABBBABAABABBABAAABAAAAAAAAABABBABBBABBBBABBBAABBABABABBAAAABAAABABAABBABBAABAAABAABAABAABABABABBAAABBBABABBAABAAABABAAAABABBAABAAABBAAAAABAABABAABBABAABBAABBBBBBBAAAAAABBABABABBBBABBAAAABBAABBBBBAABABABAABAABAABBBABBAAAABAABBABBAABBAAAABBBBAAABBAABBAABBAABAAAABBAAABBBBABBBBABABABAAABBABABBBABBBBBBBBAABABBABAABABAABBABABAABABBABAAAAABAAABBAABAAAABBBBBBBBBABAAABBAABBBAABAAABBBBBAABABABBABBBBAAAAAABABAABAAABBAAAABABBAABAAABBBABABABABBAAAAAABABBBABAAAABBAAAAABBBABBBBAABBAAAAABABABBABABBBBAAAAABAAABAAABBBBBBABBBBAABAABBAABAAAAABBBBBABABBAABAAABAABBABBBAABBBBABBAABAAAAABBAABBBBBAABBBAABABBBBBBAABAAAABAAAAABABABABABABABBABBBBAAAABABBBABBABBBABBABBBBABBBBBABABBBABABBABBBABBAABBABBAAAABBAAABBABBBABAABBBBAAABBBABABBABBBAAAABABABAAAAAAABBBAABBAAAABAAAAAAABABAABBABAABAAAAAABABBBBAABABBBABAAAABBABAABBBBABBAABBAAAAAABBBAAABABBBBBAABAABBBBBAABAABBBAABABAABAABBBBBABBAAAABBBAAAABAABBBBAAABBBBABABAABBAABBABBAAABBBABABAAABBBBABABAABAABAAABBABBBBABBBABAAABBAABBABBAAAABABABAAAABAABBAABABBBBBAABBABAAABBAABBBABAAAABAABAAAAAABAABBAABBBBABABBBABBAABAABBBBABABAABAAABBAABBAABBBBBABAAAAABBAABBAAABAABBAAABAABABAAAABAAAABBBBABABAABAABABAAAAAAAAABBBAABABAABABBBABBABBAABABBABAABAAABBAAABABBAAAAAABABABBAABBBBBAABAABAABBBBBBBABABBABBBAAABABBABAAABBBBABBBBBABABBAAAAAABBBAABABBBAAAABBBBBAABABBBBABBBAAAABABAABAABABABABBAABABABBAABBABBBBBABBBABAAABBAAAABBBBABBBABBBBBBAABBBABBBABAABABBBBAABBBBABABAABBBABBBBBBAAABAAABBBBAAAAAABAABBAABABAAABAAAABAABABAAABBAABABABAABBABBAABBBAABABABAAABBBAAAABBAAAAAABAABAAAAAAABABAABAAABABAAABBBAABABBABABBBBABBABBABABAAABBBBBBBABAAAABABABBAAAAAABBABBAAAABBBBABAAABBBBAABAABABAABBABABBBBBAABAAABBBBABABABBBABBABBBBAAAABABABABBABBABABABBABAAAABABAABBBABBAABBABBABABBBBBAAABBBAABABAAAAABAABABAAAABBAAAABBABBABBBBBBBBBAAAABBBABBBBBBBBABBABBAAABBBABABAAAABABABABABAAAABBABBAABBBBABABBBBBBABABABABAAAABBBAAABBAABBAABABBABAAAAAABAAABBBABBBABABBABBAABBABBABBABAABBBABBBAAABABABABBAABAABABAABBABAAAABABBBBBBBBAAAABBBBAABBBBBBBBABBABAAAABABBABAABAAABAABABABAAAABAAABABBBBBABBBBBABABBBABABBBBABAABABABBAAABABABAAAABBABBAAAABBBBBBAAAABAABABABBBBBBBBBBABBAABABBBBBBBBBAAABBAABBBAABBABAAABABAAAABBAAAABBBABAAABABBBAABBABAAABBBAABBBBBAAABBBBBBBBABBAABBAAABBAABAAABABBBABABABBAABABABBAABAAAAABABABABAABAAABBABABABBBBBBBBAAAABBAAAAAABAABABABAAABBBBBBBAABBBABBBAABABAABBBABAAABBABBBBBAAAAAAABBAABBABBBABABAABABAABABABBBBABAAABBABABABAAABAAABBABABAABBAAAABBBABBABBAAABAAAABBAAABABAABBABAAAABAAAABAAAAABABBBBAABAABBBAABABABABBAABBBBAAABBAAABABABBBBBABABBAABBBABAAAABABAABBABAAABBAABAAABABABAAABBABBABABABABBBAABABAABAABBBAAAABBBAAAABBBBBBBBBBAABBAAABBAAABABABBBBABBBAABABABBABAABBBABABAAABAAABABABBAABBABAAABBBABAAAAAAAAAAAAABBBBABBAAABBAAAAABBABBBAABAABBBAAAAAABBBABAAABABBBABBABABBABBBBBAAABAABAABAAABBBBBBBAABBABABBABABBBBABABAABBABABBAABBABABBABAAAAABABABABBBABABBBBAABBBABAABABABBABBAAAAAAAAAAAABAAAAAAAABABBBABBABBBBABAAAAAAABABBBAABBBBABBBABBBABBBBBABBAABBBBBBBBAAAABBBBABBAAABBAAABAAABAAABABABABBABAABBAAAAABBABABAAAABBBBABBBABBAAAAABBAAABBABAABBAABAABAABBBAABAABABBAABAABBAAAABBBBABAAAAAABABBBBBABBAAABBABBBAABAABABABABBBBBBBABABBBBAAABBBBAAAABBBBBBBAAABBBAAAAABABAAABABABBABAABBAAABAAABABAAAABBBBAAAAAABAAABBABABABAAABAABAAABBAABBBBBABAAAAABBAAAABBAABBAABBABAABABBAABAABAAAAAABABBABBBABAABAABBAABABBBAABABBABABAAAAAAAAAABAAAAAABABBABAABBAAABAABBABBABBAAAABABAABABABABBBBAABBBAAABABAABABBBBBABBBBABBBABBBBAABABBABABAABAABBAABBABBABBBBAAABBABBBABBBBABBBAABABAABBBBAABBABABAABAABABBBAABAAAABABAAABABABABAABABABBABBBBAABAABBBBBBABBABABAAABBAABBBABBBABAAAAABBBBBBAABABAABAAABBABABABBABBBABBBBABBABBABABBBBBABAABBAAABAABBAABBABABABBBBABBAABABABAABBBBABBABBABBBABABAAABBABBBABABBBBAABABAAAABABAAAAABABBBBAAABAABAABBAAABBABABBBAAABABAAAAAABBABABABBBBABBBAAAABBAABBBAABBABAAAAAABBBABAAAAABAABBABAAABABABBBAAAAABABABBBABABBAABAABBBBBBABAABBABBBAAAABABABABBBAAAAAAAAAABABABBAABBAAABABBABABBBBABABBABABAAAAAABAAAAAAAAAAABBAAAABAABABAAABABBBAAAAABBBBAABBBBABAABAAABAABAABBAAABBAABABBAABABAAABABABBABBBABBBBAABBBAABABBABBAABBAABBBBABABBBABABABABBABABAAAAABAAAABABAAAAAAAAABBABAAAAAAAAABBBAAABBBBABBBAABAAAAAABBBBAAABBABABBBBAAABAABABAABAAABAAABBABAABBAABAAABBABAABBBAAAAAAABAABABBABABBBBAABBABABBBBBAABAAAAABAABBBAABBAAABABBBBABABBABBAABBABAAABBBABBABAABAABAABAAAABABBABAABBBABABABAABAAAABBBBAABBBAAAAAAAAAAABBABABBBABAABBBBBABBABBABAABBBBBAAABAABAABBBBBAABABAAAABAAABBBAABAAAAAABBAABBABBAAABABABABBBBBBAABBAAAAAAABBBBABBAAAABABBBAAABABBBBBBAABABAABAAAABBBABABBAABBBBAAAABABBBBAAABAABBABAAAAABBBBBABBBBBAAAAABABAAAAAABABABAABBABBBBAAAABBAAABBBBABBBBABAABABABABABBBABAAAABBBAAABBABBABBBAABBABAAAAAAABAABBBBBBABABBAAABAABBABABBAABBBAAABBBABBBABBBBABBAAABABBBBAABBAAABBBAAABBBAABAABBAAABAAABAABBABBAABBAABBAAABBBAABBBBBBAAABBABABBABAAABBBABBBBBBABAABABABAABBAABBABABAAABBBAABAABBAAAAABABAABAABBBAAAAAABBABBBAAABBAABBBABBAABAABABABAAAAABBBAABAAAAAAAABAAABABAABBBBBBBBABAABBAAABBAAAABBBBBBBBBABBBBBBABABABAAABBBBBAABAABAAABBBAABABAAABABBABABBBABAAABBBAABABABBBBABBBBBABAABBBAABABAAAABBBBBAABABABAAAAABBABBBAAABAAAABAAAABABBBAAAAABAABBBAABAAAABAAABBAABBBBBBAAAAAAABAABBBAAAAABAABBBBABBBAAABAAAAAABBBABBBBBABABABAABBBABAABBAABAAABBABAAABAABBBABBABBAABAABBBAABBABBBABBBABABAAABBAABAABABBAABABAAABBBABBBBABABBAAAABBBBABBABBAABBBABABABABBBBABBBABBAAAAABABBBBAABBBAAABAAAAAABBBBBBBBAABAABAAAAABAAAABBABBAAABBAAAAAABBBBBABBAAABBBABABBBBBAABABBABABAABABBAABABABBABAABAABAAAAABABAABBAABBABBBBBAABABBAABABBAAABBBABAABAABBBAAAAAAABBBABABABAAAAABABAAABBAAABABABABAAAAABABBABBAABAABBAAABAABBABAAAABAAABABBBABBAABBBAAAABBBBBBABAABBAABBABBBABBBBABBBBAABBBAAAAAAAAABBABBBBABABAAAABABAABBBBBABAAABBBABABBBBABBBBAABABBABABABBBAABAABAABAABBBBAABAABAABAAABBABABBBBABBBBBBABBABBABAAABBABABABABBBAABBBABABBABAAABABAABBBBBBBABAAABBABBAABBAABAAAAAAABBBBABBAAABBBBBBBBBBABBBBABBBBABAABABAAAAABBAABABBABABBBBABBABBAABABAAAAABAAAAAABBAAAABAAAAABAAABAAABAABBAAABAAAAAAABAAABBBBBABABBAAAABABABABBAABBABABBAABBABBBBBBBBAABAABAAAABAABABABABBAAAAAAAAAAABBABBABABBBBBBABAAABAABBBABABBBAAABBBBAABBABBAAABBABBBBABAAAAAAABAABAABBAABAABBABABAAABAAABAABAAAABBBAAABAABBBAAAAABBBABBAAAAAABBAABAAABAAAABABABABABBABABBBAAAABBBABABABBAAABBAABBABABBABBBBBABABBAABABBAAABBAABBBAABAABBABBBABAAAABBAAAAAABBBBBBABABAABABBAABAABABAABABAABBABBBAABBBBBBBAAAAABBAAABBBABBBBBAAAABBBAAABBBAABBAAAABABBBABBBBBABAAAAAAAAABBBABAABBAABAAABAABAAAAABBABABBABBBAAAAABBAAABABAABAAAAAABAABBABABBBBAAABBBABBAAAABBBAABABAAAABBBABBBAAABAAABABABBBABBBBBBBABABAAAABAABABABBAAABBBABABBABAAABBBBABBBABABBAABBAABBABABBAAAABAABAABBAABBABAABBBABABABABABBBAABBABBAABBAAAAABABBBABBBAAABBBBABAABBBBBBBBAAABAABAABBBAABABABAAABBAAAABAAAAABABAAABBBAABAAABBAAAABABAAAABAAABBBBAAABBAABAABABABBAAAAABBBBABBABAAABABAAAAABBAABABBBABBABBAAABABABBABBAABAABABABBBAAAAAABBAABBBBBABBBBBBBBABBAABAABABABAAAABAAAAAAAAABAAABAAABBBAAABABABBBABAAAAABBBBAAABAABABAAABBBAABABABABBABBABAABBBBBABBBAABABAABAABABAAAAAAAAAABBBAABBBAABAAABBAABBBABBABABABAAAABBAABBBABABAAAABBABABABABBABABBBBBBBAAAABBBBBBAAABAABABAABBBAAAAABBBABAAABBAABBBAAABABABBAABBAABABAABABAABBBABAAABAABAABAAABBAAABAABABABAABABAAABBAAABABAAABABBBAAABBABBABBBBBABBABABBABBAABAAABBBAAAAABBBAAABBBBBABBBBBBAABAAABBBBAAABAABBABAAABBBBBBBBBAABBABBBABABAABBABBABBABBAAAAABBBBBBBBAABABABABAABAAABBBBBBAAABAABABABBAABBAABBABBABBABAABAABBBBABBAABBABABBABBABABABBBBBAAABABBAABBAAABAAAABAABABABAAAABBABAAAAABABABABBBBBBBABBBAABBAABBBABBAABBABABAABABABBBBBABABABABBBBBABBBAABAABBBBBAAAABBBABBBBAAABBBAABABBBAABBAABAABABBBBABBBBBBABABBAAAAABBBAAABAAAAABBBAABABBBBBAAABBBBBABAAABAABBAABABAABBBABBBABBAABABABABAAABBABABABBABAAABAAAAAABABBABAAAAAABBBABABABBBBABAAAABBAAABBBBBBBABAABAAAAABABABABBBBAABBABAABABBAAABBABAABBBBBBBABABBBABABAABAAAAAAABABBAABBBAAABABBAAAABBAAABABBABAAABAAABBBAAAAAAAABBBAABABBBAAAABAAAABABABAAABBBAAABABBAABBABBABBAAABBABABBABAAAABBBBBABABBBAABBAAABAABBAABBABAAABBBBAAAABAAABABABABABABBBABBBAABBABAAABBBBBBBAABABABBBBAABAAAABBBBABAAABBBAA"
        # k = 5135

        '''
        Accepted
        37/37 cases passed (368 ms)
        Your runtime beats 43.46 % of python3 submissions
        Your memory usage beats 65.48 % of python3 submissions (14.3 MB)
        '''
        n = len(s)
        tracking = {}
        for elem in s:
            if elem not in tracking:
                tracking[elem] = 0

        if len(tracking) == 1:
            return n
        if s == "":
            return 0

        start = 0
        end = 1
        tracking[s[0]] = 1

        maxct = 0
        # rangelen = start - end

        while end <= n:
            search = s[start:end]
        
            # Finding maximum occurrence of a character  
                # and get the index of it. 
            # wc = Counter(search) 
            # val = max(wc.values())

            # setmax = 0
            # for elem in set(list(search)):
            #     setct = search.count(elem)
            #     if setct >= setmax:
            #         setmax = setct
            # val = setmax
            val = max(tracking.values())
            # print(tracking, val)

            diff = end - start
            # if diff > 2:
            if diff - val > k:
                # print(search, "shift", start, end)
                tracking[s[start]] -= 1
                start += 1
                # end += 1
                # print(s[start:end], "after shift: ", start, end)

                # update counts array
            elif diff > maxct:
                maxct = diff

            if end < n:
                tracking[s[end]] += 1
            end += 1

        # print(maxct)
        return maxct
# @lc code=end

